---
title: "2025년 12월 변경 이력"
category: "history"
tier: 2
status: "active"
last_updated: "2025-12-04"
related_docs:
  - path: "docs/roadmap/current-phase.md"
    description: "현재 개발 단계"
  - path: "docs/history/changelog/2025-11.md"
    description: "2025년 11월 변경 이력"
tags:
  - changelog
  - 2025
  - december
---

# 2025년 12월 변경 이력

## 2025-12-04 (Week 16)

### QR 코드 시스템 완성 ✅

#### 1. QR 코드 자동 생성 기능
**파일**: `react-app/src/lib/qr.ts` (신규)
- QR 코드 생성 유틸리티 함수 추가
  - `createQRCodeForCard()`: 명함에 QR 코드 생성
  - `getOrCreateQRCodeUrl()`: QR URL 반환
- 6자리 랜덤 short_code 생성
- 중복 체크 및 재시도 로직
- 프로덕션/개발 환경 분기

**파일**: `react-app/src/pages/CreateCardPageOptimized.tsx`
- 명함 생성 시 QR 코드 자동 생성
- 명함 생성 성공 후 `createQRCodeForCard()` 호출
- 커스텀 URL 또는 명함 ID로 QR 타겟 URL 생성

**파일**: `react-app/supabase/migrations/20251204000002_create_qr_for_existing_cards.sql` (신규)
- 기존 명함에 QR 코드 자동 생성 SQL
- `generate_short_code()` 함수: 중복 없는 6자리 코드 생성
- 19개 기존 명함에 QR 코드 생성 완료

**커밋**: `bfe9e49` - feat: 명함 생성 시 QR 코드 자동 생성 기능 추가

#### 2. QR 코드 공유 기능 활성화
**파일**: `react-app/src/components/QRCodeGenerator.tsx`
- Web Share API 구현
  - QR 코드 이미지를 Blob으로 변환
  - `navigator.share()` API 사용
  - Fallback: URL 클립보드 복사
- 통계 버튼 제거 (중복 UI 제거)
- 공유 버튼 활성화

**커밋**: `6019c0d` - fix: QR 코드 기능 개선 및 관리자 RLS 정책 추가

#### 3. QR 리다이렉트 시스템 수정
**파일**: `react-app/vercel.json`
- rewrites 규칙 수정
  - Before: `"source": "/(.*)"`
  - After: `"source": "/:path((?!q).*)*)"`
  - `/q/` 경로를 rewrites에서 제외
- redirects가 정상 작동하도록 개선

**문제**:
- Vercel rewrites가 모든 경로를 index.html로 보내면서 redirects 무시
- QR 코드 스캔 시 빈 페이지 표시

**해결**:
- `/q/:code` 경로만 Edge Function으로 리다이렉트
- 나머지 경로는 SPA index.html로 처리

**테스트**:
```bash
curl -I "https://g-plat.com/q/urh0tm"
# HTTP 302 Found
# Location: https://anwwjowwrxdygqyhhckr.supabase.co/functions/v1/qr-redirect/urh0tm
```

**커밋**: `9b461d8` - fix: QR 코드 리다이렉트 경로 설정 수정

#### 4. Admin QR 관리 개선
**파일**: `admin-app/src/types/admin.ts`
- `QRCodeWithDetails` 인터페이스 수정
  - `business_card.user_id` 추가
  - TypeScript 빌드 에러 해결

**파일**: `react-app/supabase/migrations/20251204000001_qr_admin_policies.sql`
- Admin RLS 정책 추가
  - `is_admin_user()` 함수 사용
  - SELECT, UPDATE 정책 추가
  - 관리자가 모든 QR 코드 조회/수정 가능

**파일**: `admin-app/src/components/layout/Sidebar.tsx`
- QR 코드 메뉴명 변경
  - Before: "QR 코드"
  - After: "QR 코드 관리"

**커밋**:
- `d2fc874` - fix: Admin App QR 관리 TypeScript 타입 정의 수정
- `6019c0d` - fix: QR 코드 기능 개선 및 관리자 RLS 정책 추가

### 기술 개선
- TypeScript 빌드 에러 0개
- Vercel 배포 성공
- Edge Function 리다이렉트 정상화
- QR 코드 시스템 완전 자동화

---

## 2025-12-01 (Week 15)

### Admin App QR 코드 관리 모듈 추가 ✅

#### 파일 변경사항
- `admin-app/src/pages/qr/QrCodesPage.tsx` (신규)
- `admin-app/src/components/qr/QrDetailModal.tsx` (신규)
- `admin-app/src/lib/api/qr.ts` (신규)
- `admin-app/src/types/admin.ts` 업데이트

자세한 내용은 [2025년 11월 변경 이력](2025-11.md) 참조
