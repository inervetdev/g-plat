---
title: "2025ë…„ 12ì›” ë³€ê²½ ì´ë ¥"
category: "history"
tier: 2
status: "active"
last_updated: "2025-12-16"
related_docs:
  - path: "docs/roadmap/current-phase.md"
    description: "í˜„ì¬ ê°œë°œ ë‹¨ê³„"
  - path: "docs/history/changelog/2025-11.md"
    description: "2025ë…„ 11ì›” ë³€ê²½ ì´ë ¥"
tags:
  - changelog
  - 2025
  - december
---

# 2025ë…„ 12ì›” ë³€ê²½ ì´ë ¥

## 2025-12-16 (Week 18)

### ì‹ ê³ ê´€ë¦¬ ì‹œìŠ¤í…œ êµ¬í˜„ ì™„ë£Œ âœ…

ì‚¬ìš©ìê°€ ë¶€ì ì ˆí•œ ì½˜í…ì¸ (ëª…í•¨, ë¶€ê°€ëª…í•¨, ì‚¬ìš©ì)ë¥¼ ì‹ ê³ í•˜ê³ , ê´€ë¦¬ìê°€ ì´ë¥¼ ê²€í† /ì²˜ë¦¬í•˜ëŠ” ì‹œìŠ¤í…œ.

#### 1. ë°ì´í„°ë² ì´ìŠ¤ ë§ˆì´ê·¸ë ˆì´ì…˜
**íŒŒì¼**: `react-app/supabase/migrations/20251216000001_create_user_reports.sql` (ì‹ ê·œ)

**í…Œì´ë¸” ìƒì„±**:
- `user_reports`: ì‹ ê³  ì •ë³´ í…Œì´ë¸”
  - ì‹ ê³ ì ì •ë³´ (reporter_id, reporter_email, reporter_ip)
  - ì‹ ê³  ëŒ€ìƒ (target_type, target_id, target_owner_id)
  - ì‹ ê³  ë‚´ìš© (report_type, severity, description)
  - ì²˜ë¦¬ ìƒíƒœ (status, resolution_action, resolution_note)
- `report_action_logs`: ê´€ë¦¬ì ì²˜ë¦¬ ë¡œê·¸ í…Œì´ë¸”

**ì¸ë±ìŠ¤**:
- `idx_reports_status`: ìƒíƒœë³„ ì¡°íšŒ ìµœì í™”
- `idx_reports_target`: ëŒ€ìƒë³„ ì¡°íšŒ ìµœì í™”
- `idx_reports_severity`: ì‹¬ê°ë„ë³„ ì¡°íšŒ ìµœì í™”

#### 2. RLS ì •ì±… ìˆ˜ì • (í•µì‹¬ ë²„ê·¸ ìˆ˜ì •)
**ë¬¸ì œ**: ì‹ ê³  ì œì¶œ ì‹œ 403 Forbidden ì—ëŸ¬ ë°œìƒ

**ì›ì¸ ë¶„ì„**:
1. INSERT ì •ì±…ì— `TO anon, authenticated` ëˆ„ë½
2. GRANT ë¬¸ ë¯¸ì‹¤í–‰
3. Supabase PostgRESTì˜ `?select=id` ë™ì‘: INSERT í›„ ê²°ê³¼ ì¡°íšŒë¥¼ ìœ„í•´ SELECT ê¶Œí•œ í•„ìš”

**í•´ê²° ë°©ë²•**:
```sql
-- INSERT ì •ì±…: ì—­í•  ì§€ì • ì¶”ê°€
CREATE POLICY "Anyone can create reports" ON user_reports
  FOR INSERT
  TO anon, authenticated
  WITH CHECK (true);

-- SELECT ì •ì±…: ì‹ ê³ ì ì¡°íšŒ í—ˆìš© (INSERT í›„ ID ë°˜í™˜ìš©)
CREATE POLICY "Reporter can view own reports" ON user_reports
  FOR SELECT
  TO anon, authenticated
  USING (true);

-- ê¶Œí•œ ë¶€ì—¬
GRANT INSERT, SELECT ON user_reports TO anon;
GRANT INSERT, SELECT ON user_reports TO authenticated;
```

**ì»¤ë°‹**: `c46766d` - fix: user_reports RLS ì •ì±… ìˆ˜ì •

#### 3. Admin Reports API ìˆ˜ì •
**íŒŒì¼**: `admin-app/src/lib/api/reports.ts`

**ë¬¸ì œ**: 400 Bad Request - PostgRESTê°€ auth.users í…Œì´ë¸” ì§ì ‘ ì¡°ì¸ ë¶ˆê°€

**ì›ì¸**:
```typescript
// ì—ëŸ¬ ë°œìƒ ì½”ë“œ
.select(`
  *,
  reporter:reporter_id (id, email, name),
  target_owner:target_owner_id (id, email, name),
  reviewed_by_admin:reviewed_by (id, name)
`)
```

**í•´ê²°**:
```typescript
// ìˆ˜ì •ëœ ì½”ë“œ - auth.users ì¡°ì¸ ì œê±°
.select('*', { count: 'exact' })

// target ì •ë³´ëŠ” ê°œë³„ ì¿¼ë¦¬ë¡œ ì¡°íšŒ
if (report.target_type === 'business_card') {
  const { data: card } = await supabase
    .from('business_cards')
    .select('id, name, company, custom_url')
    .eq('id', report.target_id)
    .single()
}
```

**ì»¤ë°‹**: `277423c` - fix: admin reports APIì—ì„œ auth.users ì¡°ì¸ ì œê±°

#### 4. React App - ì‹ ê³  ë²„íŠ¼/ëª¨ë‹¬
**íŒŒì¼**:
- `react-app/src/components/report/ReportButton.tsx` (ì‹ ê·œ)
- `react-app/src/components/report/ReportModal.tsx` (ì‹ ê·œ)
- `react-app/src/lib/api/reports.ts` (ì‹ ê·œ)

**ê¸°ëŠ¥**:
- ëª…í•¨ ìƒì„¸ í˜ì´ì§€ í•˜ë‹¨ì— "ğŸš¨ ì‹ ê³ í•˜ê¸°" ë²„íŠ¼
- ì‹ ê³  ìœ í˜• ì„ íƒ: ìŠ¤íŒ¸, ë¶€ì ì ˆ, ì‚¬ê¸°, ì €ì‘ê¶Œ, ê°œì¸ì •ë³´, ê¸°íƒ€
- ìƒì„¸ ì„¤ëª… ì…ë ¥ (ì„ íƒ)
- ì´ë©”ì¼ ì…ë ¥ (ê²°ê³¼ ì•Œë¦¼ìš©)

#### 5. Admin App - ì‹ ê³  ê´€ë¦¬
**íŒŒì¼**:
- `admin-app/src/pages/reports/ReportsPage.tsx` (ì‹ ê·œ)
- `admin-app/src/components/reports/ReportDetailModal.tsx` (ì‹ ê·œ)
- `admin-app/src/lib/api/reports.ts` (ì‹ ê·œ)

**ê¸°ëŠ¥**:
- ì‹ ê³  ëª©ë¡: í˜ì´ì§€ë„¤ì´ì…˜, í•„í„°ë§ (ìƒíƒœ/ìœ í˜•/ì‹¬ê°ë„)
- ì‹ ê³  ìƒì„¸: ì‹ ê³  ì •ë³´, ëŒ€ìƒ ì½˜í…ì¸  ì •ë³´
- ì²˜ë¦¬ ì¡°ì¹˜:
  - `delete_content`: ì½˜í…ì¸  ì‚­ì œ
  - `disable_content`: ì½˜í…ì¸  ë¹„í™œì„±í™” (is_active=false)
  - `warn_user`: ì‚¬ìš©ì ê²½ê³ 
  - `suspend_user`: ì‚¬ìš©ì ì •ì§€
  - `ban_user`: ì‚¬ìš©ì ì˜êµ¬ ì°¨ë‹¨
  - `reject_report`: ì‹ ê³  ê¸°ê°

#### 6. ì•Œë¦¼ ê¸°ëŠ¥ ìƒíƒœ
**í˜„ì¬ ìƒíƒœ**: âš ï¸ ë¯¸êµ¬í˜„

- `notify_reporter` í•„ë“œ: DBì— ì €ì¥ë§Œ ë¨
- ì‹¤ì œ ì´ë©”ì¼ ë°œì†¡ ê¸°ëŠ¥: í–¥í›„ êµ¬í˜„ ì˜ˆì •
- Resend SMTP ì—°ë™ í•„ìš”

### ì‹ ê³  ì›Œí¬í”Œë¡œìš°
```
[ë°©ë¬¸ì] ëª…í•¨ ì—´ëŒ â†’ ë¶€ì ì ˆí•œ ì½˜í…ì¸  ë°œê²¬ â†’ ğŸš¨ ì‹ ê³  ë²„íŠ¼ í´ë¦­
                                              â†“
                                    ì‹ ê³  ì ‘ìˆ˜ (pending)
                                              â†“
                                    [ê´€ë¦¬ì] ì‹ ê³  ê²€í† 
                                              â†“
                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                        â†“                     â†“                     â†“
                   ì½˜í…ì¸  ì‚­ì œ            ì‚¬ìš©ì ê²½ê³             ì‹ ê³  ê¸°ê°
                   (resolved)           (resolved)           (rejected)
```

### ì»¤ë°‹ ì´ë ¥
- `c32cbe8` - feat: ì‹ ê³ ê´€ë¦¬ ì‹œìŠ¤í…œ êµ¬í˜„
- `c46766d` - fix: user_reports RLS ì •ì±… ìˆ˜ì •
- `277423c` - fix: admin reports APIì—ì„œ auth.users ì¡°ì¸ ì œê±°

---

## 2025-12-14 (Week 18)

### Resend SMTP ì´ë©”ì¼ ì‹œìŠ¤í…œ êµ¬ì¶• ì™„ë£Œ âœ…

Supabase ê¸°ë³¸ ì´ë©”ì¼ ì„œë¹„ìŠ¤ì˜ rate limit ë¬¸ì œë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ Resend ì»¤ìŠ¤í…€ SMTPë¥¼ ì„¤ì •.

#### 1. Resend ë„ë©”ì¸ ì„¤ì •
**ë„ë©”ì¸**: `sign.g-plat.com`

**DNS ë ˆì½”ë“œ (Vercel)**:
- DKIM: `resend._domainkey.sign` â†’ TXT ë ˆì½”ë“œ
- SPF (MX): `send.sign` â†’ MX ë ˆì½”ë“œ (priority 10)
- SPF (TXT): `send.sign` â†’ TXT ë ˆì½”ë“œ (`v=spf1 include:amazonses.com ~all`)

**ìƒíƒœ**: ëª¨ë“  ë ˆì½”ë“œ Verified âœ…

#### 2. Supabase SMTP ì„¤ì •
**Supabase Management APIë¥¼ í†µí•´ ì„¤ì •**:

```json
{
  "smtp_host": "smtp.resend.com",
  "smtp_port": "465",
  "smtp_user": "resend",
  "smtp_pass": "re_MYaq2QQq_...",
  "smtp_admin_email": "noreply@sign.g-plat.com",
  "smtp_sender_name": "G-Plat",
  "rate_limit_email_sent": 30
}
```

**ê²°ê³¼**:
- âœ… íšŒì›ê°€ì… ì´ë©”ì¼ ì¸ì¦ ì •ìƒ ì‘ë™
- âœ… ë¹„ë°€ë²ˆí˜¸ ì¬ì„¤ì • ì´ë©”ì¼ ë°œì†¡ ê°€ëŠ¥
- âœ… Rate limit: 30íšŒ/ì‹œê°„ (ê¸°ì¡´ 2íšŒì—ì„œ ëŒ€í­ ì¦ê°€)

#### 3. API í‚¤ ê´€ë¦¬
- **ì œí•œëœ í‚¤**: `re_SRdcM3wN_...` (ì´ë©”ì¼ ë°œì†¡ë§Œ ê°€ëŠ¥, ë„ë©”ì¸ ì¡°íšŒ ë¶ˆê°€)
- **ì „ì²´ ê¶Œí•œ í‚¤**: `re_MYaq2QQq_...` (ë„ë©”ì¸ ì¸ì¦ í›„ ìƒì„±, ëª¨ë“  ê¶Œí•œ)

**ì£¼ì˜**: API í‚¤ëŠ” ë„ë©”ì¸ ì¸ì¦ í›„ ìƒì„±í•´ì•¼ í•´ë‹¹ ë„ë©”ì¸ì— ëŒ€í•œ ê¶Œí•œì´ ë¶€ì—¬ë¨.

---

### ì‚¬ìš©ì ì‚­ì œ ì‹œ auth.users ë™ì‹œ ì‚­ì œ âœ…

ê´€ë¦¬ìê°€ ì‚¬ìš©ìë¥¼ ì‚­ì œí•´ë„ `auth.users` í…Œì´ë¸”ì—ì„œ ì‚­ì œë˜ì§€ ì•Šì•„ ë¡œê·¸ì¸ì´ ê°€ëŠ¥í–ˆë˜ ë¬¸ì œ í•´ê²°.

#### 1. Edge Function ìƒì„±
**íŒŒì¼**: `react-app/supabase/functions/delete-auth-user/index.ts` (ì‹ ê·œ)

```typescript
// Service Role Keyë¡œ auth.admin.deleteUser() í˜¸ì¶œ
const { error: deleteError } = await supabaseAdmin.auth.admin.deleteUser(userId)
```

**ë³´ì•ˆ**:
- í˜¸ì¶œìê°€ `admin_users` í…Œì´ë¸”ì— ì¡´ì¬í•˜ëŠ”ì§€ í™•ì¸
- Authorization í—¤ë” í•„ìˆ˜

#### 2. Admin API ìˆ˜ì •
**íŒŒì¼**: `admin-app/src/lib/api/users.ts`

```typescript
async function deleteAuthUser(userId: string): Promise<void> {
  const response = await fetch(`${supabaseUrl}/functions/v1/delete-auth-user`, {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json',
      'Authorization': `Bearer ${session.access_token}`,
    },
    body: JSON.stringify({ userId }),
  })
}

export async function deleteUser(userId: string, permanent = false, reason?: string) {
  // 1. auth.usersì—ì„œ ì‚­ì œ (ë¡œê·¸ì¸ ì°¨ë‹¨)
  await deleteAuthUser(userId)

  // 2. users í…Œì´ë¸”ì—ì„œ soft/hard delete
  // ...
}
```

**íš¨ê³¼**:
- âœ… ì‚­ì œëœ ì‚¬ìš©ì ì¬ë¡œê·¸ì¸ ë¶ˆê°€
- âœ… Soft delete ì‹œì—ë„ auth.users ì‚­ì œ
- âœ… ì¬ê°€ì… ê°€ëŠ¥ (ì™„ì „íˆ ìƒˆ ê³„ì •ìœ¼ë¡œ)

---

### Admin ì§€ë„ ë¯¸ë¦¬ë³´ê¸° ë¡œë”© ìˆ˜ì • âœ…

ëª…í•¨ ìƒì„± í˜ì´ì§€ì—ì„œ "ì§€ë„ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘..." í™”ë©´ì´ ë¬´í•œíˆ í‘œì‹œë˜ëŠ” ë¬¸ì œ í•´ê²°.

#### ë¬¸ì œ ì›ì¸
Kakao Maps SDKì˜ `autoload=false` ì˜µì…˜ ì‚¬ìš© ì‹œ, `window.kakao.maps.load()` ì½œë°±ì´ ì™„ë£Œë˜ê¸° ì „ì—ëŠ” APIë¥¼ ì‚¬ìš©í•  ìˆ˜ ì—†ìŒ.
ê¸°ì¡´ ì½”ë“œëŠ” `window.kakao.maps` ì¡´ì¬ ì—¬ë¶€ë§Œ í™•ì¸í•˜ì—¬ SDKê°€ ì¤€ë¹„ë˜ì§€ ì•Šì€ ìƒíƒœì—ì„œ ì§€ë„ ìƒì„± ì‹œë„.

#### í•´ê²° ë°©ë²•

**íŒŒì¼**: `admin-app/index.html`
```html
<script>
  window.kakaoMapsReady = false;
  (function() {
    const script = document.createElement('script');
    script.src = '//dapi.kakao.com/v2/maps/sdk.js?appkey=...&autoload=false';
    script.onload = function() {
      window.kakao.maps.load(function() {
        window.kakaoMapsReady = true;
        window.dispatchEvent(new Event('kakao-maps-loaded'));
      });
    };
    document.head.appendChild(script);
  })();
</script>
```

**íŒŒì¼**: `admin-app/src/components/common/MapPreview.tsx`
```typescript
const [isMapReady, setIsMapReady] = useState(false)

useEffect(() => {
  const initMap = () => {
    if (!window.kakaoMapsReady) return
    // ì§€ë„ ìƒì„±...
    setIsMapReady(true)
  }

  if (window.kakaoMapsReady) {
    initMap()
  } else {
    window.addEventListener('kakao-maps-loaded', initMap)
    // Fallback: 100ms ê°„ê²© í´ë§
  }
}, [])
```

**íš¨ê³¼**:
- âœ… SDK ë¡œë“œ ì™„ë£Œ í›„ì—ë§Œ ì§€ë„ ìƒì„±
- âœ… ë¡œë”© ìƒíƒœ ì •í™•í•˜ê²Œ í‘œì‹œ
- âœ… ì´ë²¤íŠ¸ ê¸°ë°˜ + í´ë§ fallbackìœ¼ë¡œ ì•ˆì •ì„± í™•ë³´

---

## 2025-12-11 (Week 17)

### êµ¬ë… ë“±ê¸‰ ì‹œìŠ¤í…œ êµ¬í˜„ ì™„ë£Œ âœ…

3ë‹¨ê³„ êµ¬ë… ë“±ê¸‰ ì‹œìŠ¤í…œ(ë¬´ë£Œ/ìœ ë£Œ/í”„ë¦¬ë¯¸ì—„) êµ¬í˜„ - ëª…í•¨/ë¶€ê°€ëª…í•¨ ìƒì„± ì œí•œ ë° í†µê³„ ì ‘ê·¼ ì œì–´

#### 1. ë°ì´í„°ë² ì´ìŠ¤ ë ˆì´ì–´ (Phase 1)
**íŒŒì¼**: `react-app/supabase/migrations/20251212000001_subscription_tier_limits.sql` (ì‹ ê·œ)

**êµ¬í˜„ ë‚´ìš©**:
- `users.grandfathered` ì»¬ëŸ¼ ì¶”ê°€ (ê¸°ì¡´ ì‚¬ìš©ì ë³´í˜¸)
- ë“±ê¸‰ë³„ ì œí•œ ì²´í¬ í•¨ìˆ˜ ìƒì„±:
  ```sql
  CREATE OR REPLACE FUNCTION check_card_limit_by_tier()
  -- FREE: 3ê°œ, PREMIUM: 10ê°œ, BUSINESS: ë¬´ì œí•œ

  CREATE OR REPLACE FUNCTION check_sidejob_limit_by_tier()
  -- FREE: 5ê°œ, PREMIUM: 30ê°œ, BUSINESS: ë¬´ì œí•œ
  ```
- RPC í•¨ìˆ˜: `get_user_tier_limits(p_user_id UUID)`
  - í”„ë¡ íŠ¸ì—”ë“œì—ì„œ ë“±ê¸‰ ì •ë³´ ì¡°íšŒìš©
  - tier, max_cards, max_sidejobs, has_callbacks, has_advanced_stats ë°˜í™˜
- `tier_limit_violations` ë¡œê¹… í…Œì´ë¸” ìƒì„±
- INSERT íŠ¸ë¦¬ê±° ì¤€ë¹„ (ì•ˆì „í•œ ë°°í¬ ìœ„í•´ í˜„ì¬ ë¹„í™œì„±í™”)

**Grandfathering ì „ëµ**:
- ê¸°ì¡´ ì‚¬ìš©ì ì¤‘ ìƒˆ ì œí•œ ì´ˆê³¼ì ìë™ `grandfathered=TRUE` ì„¤ì •
- ê¸°ì¡´ ëª…í•¨/ë¶€ê°€ëª…í•¨ ìœ ì§€, ìƒˆ ìƒì„±ë§Œ ì œí•œ
- UIì— "â­ ì–¼ë¦¬ì–´ë‹µí„° íŠ¹ë³„ í˜œíƒ" ë°°ì§€ í‘œì‹œ

#### 2. í”„ë¡ íŠ¸ì—”ë“œ ë¼ì´ë¸ŒëŸ¬ë¦¬ (Phase 2)
**íŒŒì¼**: `react-app/src/lib/subscription.ts` (ì‹ ê·œ)

**ì£¼ìš” export**:
- `TIER_CONFIG`: ë“±ê¸‰ë³„ ì œí•œ ìƒìˆ˜
  ```typescript
  FREE: { cardLimit: 3, sidejobLimit: 5, hasCallbacks: false, hasAdvancedStats: false }
  PREMIUM: { cardLimit: 10, sidejobLimit: 30, hasCallbacks: true, hasAdvancedStats: true }
  BUSINESS: { cardLimit: Infinity, sidejobLimit: Infinity, ... }
  ```
- `getUserTierLimits()`: RPC í˜¸ì¶œ
- `canCreateCard()`, `canCreateSidejob()`: ìƒì„± ê°€ëŠ¥ ì—¬ë¶€ ì²´í¬
- `getUsagePercentage()`, `isNearLimit()`, `isAtLimit()`: ì‚¬ìš©ëŸ‰ ê³„ì‚°

**íŒŒì¼**: `react-app/src/stores/subscriptionStore.ts` (ì‹ ê·œ)
- Zustand ê¸°ë°˜ ì „ì—­ ìƒíƒœ ê´€ë¦¬
- 5ë¶„ ìºì‹± ì „ëµ (DB ë¶€í•˜ ê°ì†Œ)
- `fetchLimits()`, `reset()`, `refetch()` ì•¡ì…˜

**íŒŒì¼**: `react-app/src/contexts/AuthContext.tsx` (ìˆ˜ì •)
- ë¡œê·¸ì¸ ì‹œ ìë™ `fetchLimits(user.id)` í˜¸ì¶œ
- ë¡œê·¸ì•„ì›ƒ ì‹œ ìë™ `resetLimits()` í˜¸ì¶œ

#### 3. UI ì»´í¬ë„ŒíŠ¸ (Phase 3)
**íŒŒì¼**: `react-app/src/components/UpgradePrompt.tsx` (ì‹ ê·œ)
- ì—…ê·¸ë ˆì´ë“œ CTA ì»´í¬ë„ŒíŠ¸
- ë‹¤ìŒ ë“±ê¸‰ ê¸°ëŠ¥ ë° ê°€ê²© í‘œì‹œ
- ê¸°ëŠ¥ë³„ ë§ì¶¤ ë©”ì‹œì§€ (cards, sidejobs, callbacks, stats)
- "ì—…ê·¸ë ˆì´ë“œí•˜ê¸°" ë²„íŠ¼ (ê²°ì œ ì—°ë™ì€ Phase 2ì—ì„œ êµ¬í˜„ ì˜ˆì •)

**íŒŒì¼**: `react-app/src/components/TierLimitBadge.tsx` (ì‹ ê·œ)
- ì‚¬ìš©ëŸ‰ ë°°ì§€: "ëª…í•¨ 2/3" í˜•ì‹
- ìƒ‰ìƒ ì½”ë“œ:
  - íŒŒë€ìƒ‰ (<80% ì‚¬ìš©)
  - ë…¸ë€ìƒ‰ (80-99% ì‚¬ìš©)
  - ë¹¨ê°„ìƒ‰ (100% ì œí•œ ë„ë‹¬)
- ë¬´ì œí•œ í”Œëœ: "âˆ" í‘œì‹œ
- Grandfathered ì‚¬ìš©ì: "íŠ¹ë³„ í˜œíƒ" í‘œì‹œ
- ë‘ ê°€ì§€ ë³€í˜•: ê°„ë‹¨í•œ ë°°ì§€ / ì§„í–‰ë°” í¬í•¨ ë°°ì§€

**íŒŒì¼**: `react-app/src/components/RestrictedStatsOverlay.tsx` (ì‹ ê·œ)
- í†µê³„ ì œí•œ ì˜¤ë²„ë ˆì´ ì»´í¬ë„ŒíŠ¸
- íë¦° ë°°ê²½ + ì ê¸ˆ ì•„ì´ì½˜
- ì—…ê·¸ë ˆì´ë“œ í”„ë¡¬í”„íŠ¸ ë‚´ì¥
- FREE ì‚¬ìš©ì ê³ ê¸‰ í†µê³„ í˜ì´ì§€ì— ì ìš©

#### 4. í˜ì´ì§€ í†µí•© (Phase 4)
**íŒŒì¼**: `react-app/src/pages/DashboardPageOptimized.tsx` (ìˆ˜ì •)
- í—¤ë”ì— ë“±ê¸‰ ë°°ì§€ í‘œì‹œ
- Grandfathered ë°°ì§€ í‘œì‹œ
- ëª…í•¨/ë¶€ê°€ëª…í•¨ ì‚¬ìš©ëŸ‰ ì§„í–‰ë°” ì¶”ê°€

**íŒŒì¼**: `react-app/src/pages/CreateCardPageOptimized.tsx` (ìˆ˜ì •)
- `canCreateCard()` ì²´í¬
- ì œí•œ ë„ë‹¬ ì‹œ ì „ì²´ í˜ì´ì§€ UpgradePrompt í‘œì‹œ
- í—¤ë”ì— TierLimitBadge í‘œì‹œ

**íŒŒì¼**: `react-app/src/pages/SideJobCardsPageOptimized.tsx` (ìˆ˜ì •)
- `canCreateSidejob()` ì²´í¬
- "ìƒˆ ë¶€ê°€ëª…í•¨ ì¶”ê°€" ë²„íŠ¼ ë¹„í™œì„±í™” (ì œí•œ ë„ë‹¬ ì‹œ)
- í´ë¦­ ì‹œ UpgradePrompt ëª¨ë‹¬ í‘œì‹œ
- í—¤ë”ì— TierLimitBadge í‘œì‹œ

**íŒŒì¼**: `react-app/src/pages/StatsPageOptimized.tsx` (ìˆ˜ì •)
- `hasAdvancedStats` ì²´í¬
- **ë¬´ë£Œ í”Œëœ (FREE)** - ê¸°ë³¸ í†µê³„ë§Œ:
  - âœ… ì´ ì¡°íšŒìˆ˜, ì˜¤ëŠ˜, ì´ë²ˆì£¼, ì´ë²ˆë‹¬, ê³ ìœ  ë°©ë¬¸ì
- **ìœ ë£Œ/í”„ë¦¬ë¯¸ì—„ í”Œëœ** - ê³ ê¸‰ í†µê³„:
  - âœ… ì†Œê°œìë£Œ ë‹¤ìš´ë¡œë“œ í†µê³„
  - âœ… QR ìŠ¤ìº” í†µê³„
  - âœ… ì¼ë³„ ë°©ë¬¸ ì¶”ì´ ì°¨íŠ¸
  - âœ… ë””ë°”ì´ìŠ¤ë³„ ì ‘ì†, ë¸Œë¼ìš°ì € ë¶„í¬
  - âœ… ìƒìœ„ ìœ ì… ê²½ë¡œ, ìµœê·¼ ë°©ë¬¸ì
- FREE ì‚¬ìš©ìì—ê²ŒëŠ” RestrictedStatsOverlay í‘œì‹œ

#### 5. ë¬¸ì„œ ì—…ë°ì´íŠ¸ (Phase 6)
**íŒŒì¼**: `prd.md` (ìˆ˜ì •)
- ë¹„ì¦ˆë‹ˆìŠ¤ ëª¨ë¸ ì„¹ì…˜ ì—…ë°ì´íŠ¸ (line 146-148)
- ìƒˆë¡œìš´ ë“±ê¸‰ë³„ ì œí•œ ë°˜ì˜:
  - ë¬´ë£Œ: ëª…í•¨ 3ê°œ, ë¶€ê°€ëª…í•¨ 5ê°œ, ê¸°ë³¸ í†µê³„ë§Œ, ì½œë°± ë¯¸ì œê³µ
  - ìœ ë£Œ: ëª…í•¨ 10ê°œ, ë¶€ê°€ëª…í•¨ 30ê°œ, ì „ì²´ í†µê³„, ì½œë°± ì œê³µ
  - í”„ë¦¬ë¯¸ì—„: ë¬´ì œí•œ, íŠ¹í™” ì„œë¹„ìŠ¤

**íŒŒì¼**: `docs/features/subscription/README.md` (ì‹ ê·œ)
- êµ¬ë… ì‹œìŠ¤í…œ ì „ì²´ ë¬¸ì„œ ì‘ì„±
- ë“±ê¸‰ êµ¬ì¡°, ê¸°ëŠ¥ ì œí•œ, ì•„í‚¤í…ì²˜ ì„¤ëª…
- ë°ì´í„°ë² ì´ìŠ¤ êµ¬ì¡° ë° RPC í•¨ìˆ˜ ë¬¸ì„œí™”
- ì‚¬ìš©ë²• ì˜ˆì œ ì½”ë“œ
- í…ŒìŠ¤íŠ¸ ê°€ì´ë“œ, ë°°í¬ ì „ëµ
- ë³´ì•ˆ ê³ ë ¤ì‚¬í•­, ì‚¬ìš©ì ê²½í—˜ ì›ì¹™

**íŒŒì¼**: `docs/history/changelog/2025-12.md` (ìˆ˜ì •)
- êµ¬ë… ë“±ê¸‰ ì‹œìŠ¤í…œ êµ¬í˜„ ì´ë ¥ ì¶”ê°€

### êµ¬ë… ë“±ê¸‰ë³„ ì œí•œ ìš”ì•½

| ë“±ê¸‰ | DB Enum | ëª…í•¨ | ë¶€ê°€ëª…í•¨ | ì½œë°± | í†µê³„ |
|------|---------|------|---------|------|------|
| ë¬´ë£Œ | `FREE` | 3ê°œ | 5ê°œ | âŒ | ê¸°ë³¸ë§Œ |
| ìœ ë£Œ | `PREMIUM` | 10ê°œ | 30ê°œ | âœ… | ì „ì²´ |
| í”„ë¦¬ë¯¸ì—„ | `BUSINESS` | ë¬´ì œí•œ | ë¬´ì œí•œ | âœ… | ì „ì²´ + íŠ¹í™” |

### ë°°í¬ ê³„íš
1. **1ë‹¨ê³„ (í˜„ì¬)**: í”„ë¡ íŠ¸ì—”ë“œë§Œ ë°°í¬, íŠ¸ë¦¬ê±° ë¹„í™œì„±í™”
   - ì‚¬ìš©ìëŠ” UIì—ì„œ ì œí•œì„ ë³¼ ìˆ˜ ìˆì§€ë§Œ ê°•ì œë˜ì§€ ì•ŠìŒ
   - 1ì£¼ì¼ ëª¨ë‹ˆí„°ë§ ë° í”¼ë“œë°± ìˆ˜ì§‘
2. **2ë‹¨ê³„ (ì•ˆì •í™” í›„)**: ë°ì´í„°ë² ì´ìŠ¤ íŠ¸ë¦¬ê±° í™œì„±í™”
   - INSERT ì‹œ ë“±ê¸‰ë³„ ì œí•œ ê°•ì œ ì ìš©
   - ë¡¤ë°± ê³„íš ì¤€ë¹„ ì™„ë£Œ

### ë‹¤ìŒ ë‹¨ê³„ (Phase 2)
- Toss Payments ê²°ì œ ì‹œìŠ¤í…œ ì—°ë™
- 14ì¼ ë¬´ë£Œ ì²´í—˜ êµ¬í˜„
- ì½œë°± ì‹œìŠ¤í…œ ì œí•œ ì ìš©
- í”„ë¦¬ë¯¸ì—„ íŠ¹í™” ì„œë¹„ìŠ¤ (í™˜ê¸‰ê¸ˆ ê³„ì‚°ê¸°, AI ìƒë‹´ì‚¬, TM)

### Admin App êµ¬ë… ë“±ê¸‰ ê´€ë¦¬ ê¸°ëŠ¥ âœ…

#### 1. ì‚¬ìš©ì ëª©ë¡ ë“±ê¸‰ ê´€ë¦¬
**íŒŒì¼**: `admin-app/src/pages/users/UsersPage.tsx`

**TierDropdown ì»´í¬ë„ŒíŠ¸ ì¶”ê°€**:
- ì‚¬ìš©ì ëª©ë¡ì—ì„œ ë“œë¡­ë‹¤ìš´ìœ¼ë¡œ ë“±ê¸‰ ì¦‰ì‹œ ë³€ê²½
- ì•„ì´ì½˜ í‘œì‹œ: ë¬´ë£Œ(ì—†ìŒ), í”„ë¦¬ë¯¸ì—„(Zap), ë¹„ì¦ˆë‹ˆìŠ¤(Crown)
- ìƒ‰ìƒ ì½”ë“œ: ë¬´ë£Œ(íšŒìƒ‰), í”„ë¦¬ë¯¸ì—„(íŒŒë€ìƒ‰), ë¹„ì¦ˆë‹ˆìŠ¤(ë³´ë¼ìƒ‰)
- í´ë¦­ ì™¸ë¶€ ì˜ì—­ ë‹«ê¸° ì²˜ë¦¬ (useRef + clickOutside)

```typescript
function TierDropdown({
  user,
  onTierChange,
  isUpdating
}: {
  user: UserWithStats
  onTierChange: (userId: string, tier: 'FREE' | 'PREMIUM' | 'BUSINESS', grandfathered?: boolean) => void
  isUpdating: boolean
})
```

#### 2. ì‚¬ìš©ì ìƒì„¸ í˜ì´ì§€ ë“±ê¸‰ ê´€ë¦¬
**íŒŒì¼**: `admin-app/src/components/users/detail/UserInfoTab.tsx`

**TIER_LIMITS ìƒìˆ˜ ì •ì˜**:
```typescript
const TIER_LIMITS = {
  FREE: { maxCards: 3, maxSidejobs: 5, name: 'ë¬´ë£Œ' },
  PREMIUM: { maxCards: 10, maxSidejobs: 30, name: 'í”„ë¦¬ë¯¸ì—„' },
  BUSINESS: { maxCards: 999999, maxSidejobs: 999999, name: 'ë¹„ì¦ˆë‹ˆìŠ¤' },
}
```

**ì–¼ë¦¬ì–´ë‹µí„° (grandfathered) í† ê¸€**:
- ì²´í¬ë°•ìŠ¤ UI (peer ìŠ¤íƒ€ì¼ë§)
- í™œì„±í™” ì‹œ ë“±ê¸‰ ì œí•œ ë¬´ì‹œ
- "ì–¼ë¦¬ì–´ë‹µí„° ì‚¬ìš©ìëŠ” ë“±ê¸‰ ì œí•œì— ê´€ê³„ì—†ì´ ë¬´ì œí•œ ëª…í•¨/ë¶€ê°€ëª…í•¨ ìƒì„± ê°€ëŠ¥" ì•ˆë‚´ ë¬¸êµ¬

**ì‚¬ìš©ëŸ‰ ë° ì œí•œ ì¹´ë“œ**:
- ëª…í•¨/ë¶€ê°€ëª…í•¨ ì‚¬ìš©ëŸ‰ í”„ë¡œê·¸ë ˆìŠ¤ ë°”
- ìƒ‰ìƒ ì½”ë“œ:
  - íŒŒë€ìƒ‰ (<80% ì‚¬ìš©)
  - ë…¸ë€ìƒ‰ (80-99% ì‚¬ìš©)
  - ë¹¨ê°„ìƒ‰ (100% ì œí•œ ë„ë‹¬)
- "ëª…í•¨ Nê°œ, ë¶€ê°€ëª…í•¨ Nê°œ ì œí•œ" í…ìŠ¤íŠ¸ í‘œì‹œ

#### 3. íƒ€ì… ì •ì˜ ì—…ë°ì´íŠ¸
**íŒŒì¼**: `admin-app/src/types/admin.ts`

```typescript
export interface User {
  // ... ê¸°ì¡´ í•„ë“œ
  grandfathered?: boolean  // ê¸°ì¡´ ì‚¬ìš©ì íŠ¹ë³„ í˜œíƒ í”Œë˜ê·¸
}
```

**ì»¤ë°‹**: `d871dad` - feat(admin): êµ¬ë… ë“±ê¸‰ ê´€ë¦¬ ê¸°ëŠ¥ ì¶”ê°€

---

## 2025-12-11 (Week 17 ê³„ì†)

### ê´€ë¦¬ì ëª…í•¨ ê´€ë¦¬ ê¸°ëŠ¥ ì™„ì„± âœ…

#### 1. ê´€ë¦¬ì ëª…í•¨ ìƒì„± ê¸°ëŠ¥ ê°œì„ 
**íŒŒì¼**: `admin-app/src/lib/api/cards.ts`, `admin-app/src/components/cards/CardCreateModal.tsx`

**ë¬¸ì œ**: ëª…í•¨ì´ ì—†ëŠ” ì‹ ê·œ íšŒì›ì„ ê²€ìƒ‰í•  ìˆ˜ ì—†ì—ˆìŒ (business_cards í…Œì´ë¸”ë§Œ ê²€ìƒ‰)

**í•´ê²°**:
- `fetchUsersForCardCreate()` í•¨ìˆ˜ë¥¼ users í…Œì´ë¸” ê¸°ë°˜ìœ¼ë¡œ ë³€ê²½
- ì´ë¦„ + ì´ë©”ì¼ ë™ì‹œ ê²€ìƒ‰ ì§€ì›
  ```typescript
  query.or(`name.ilike.%${search}%,email.ilike.%${search}%`)
  ```

**UI ê°œì„ **:
- ê²€ìƒ‰ placeholder: "ì‚¬ìš©ì ì´ë¦„ ë˜ëŠ” ì´ë©”ì¼ë¡œ ê²€ìƒ‰..."
- ê²€ìƒ‰ ê²°ê³¼ì— ì´ë©”ì¼ í‘œì‹œ
- ì„ íƒëœ ì‚¬ìš©ì ì •ë³´: ì´ë¦„ + ì´ë©”ì¼ ëª¨ë‘ í‘œì‹œ
- "ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤" ë©”ì‹œì§€ ì¶”ê°€

**ì»¤ë°‹**: `dc707e9` - fix: ëª…í•¨ ìƒì„± ì‹œ ëª¨ë“  ì‚¬ìš©ì ê²€ìƒ‰ ê°€ëŠ¥í•˜ë„ë¡ ê°œì„ 

#### 2. ëª…í•¨ ì‚­ì œ ê¸°ëŠ¥ ì¶”ê°€
**íŒŒì¼**: `admin-app/src/pages/cards/CardDetailPage.tsx`

**êµ¬í˜„ ë‚´ìš©**:
- ìš°ì¸¡ ìƒë‹¨ "ì‚­ì œ" ë²„íŠ¼ ì¶”ê°€
- ì‚­ì œ í™•ì¸ ëª¨ë‹¬ êµ¬í˜„
  - AlertTriangle ì•„ì´ì½˜
  - ëª…í•¨ ì†Œìœ ì ì´ë¦„ í‘œì‹œ
  - "ì´ ì‘ì—…ì€ ë˜ëŒë¦´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤" ê²½ê³ 
- Soft delete ë°©ì‹ (`is_active = false`)
- ì‚­ì œ ì¤‘ ë¡œë”© ìƒíƒœ í‘œì‹œ (ìŠ¤í”¼ë„ˆ + "ì‚­ì œ ì¤‘...")
- ì‚­ì œ ì„±ê³µ í›„ ëª…í•¨ ëª©ë¡ìœ¼ë¡œ ìë™ ì´ë™

**ì½”ë“œ**:
```typescript
const handleDelete = async () => {
  if (!id) return
  setIsDeleting(true)
  try {
    await deleteCard(id, false) // soft delete
    alert('ëª…í•¨ì´ ì„±ê³µì ìœ¼ë¡œ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤')
    navigate('/cards')
  } catch (error) {
    console.error('Error deleting card:', error)
    alert('ëª…í•¨ ì‚­ì œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤')
  } finally {
    setIsDeleting(false)
    setIsDeleteModalOpen(false)
  }
}
```

**ì»¤ë°‹**: `f0c9666` - feat: ëª…í•¨ ìƒì„¸ í˜ì´ì§€ì— ì‚­ì œ ê¸°ëŠ¥ ì¶”ê°€

#### 3. ëª…í•¨ ëª©ë¡ í•„í„° ê°œì„ 
**íŒŒì¼**: `admin-app/src/lib/api/cards.ts`

**ë¬¸ì œ**: ì‚­ì œëœ ëª…í•¨(is_active=false)ì´ ëª©ë¡ì— ê³„ì† í‘œì‹œë¨

**í•´ê²°**:
- `fetchCards()` ê¸°ë³¸ ë™ì‘: `is_active=true`ì¸ ëª…í•¨ë§Œ ì¡°íšŒ
- status í•„í„°ê°€ 'all'ì´ì–´ë„ í™œì„± ëª…í•¨ë§Œ í‘œì‹œ

**ë³€ê²½ ì „**:
```typescript
if (filters.status && filters.status !== 'all') {
  const isActive = filters.status === 'active'
  query = query.eq('is_active', isActive)
}
```

**ë³€ê²½ í›„**:
```typescript
if (filters.status && filters.status !== 'all') {
  const isActive = filters.status === 'active'
  query = query.eq('is_active', isActive)
} else if (!filters.status || filters.status === 'all') {
  // Default: only show active cards
  query = query.eq('is_active', true)
}
```

**íš¨ê³¼**:
- âœ… ì‚­ì œëœ ëª…í•¨ ëª©ë¡ì—ì„œ ìë™ ìˆ¨ê¹€
- âœ… ì‚­ì œ í›„ ì¦‰ì‹œ ëª©ë¡ì—ì„œ ì‚¬ë¼ì§
- âœ… status='all' í•„í„° ì‚¬ìš© ì‹œì—ë„ í™œì„± ëª…í•¨ë§Œ í‘œì‹œ

**ì»¤ë°‹**: `a7f87b8` - fix: ëª…í•¨ ëª©ë¡ì—ì„œ ì‚­ì œëœ ëª…í•¨ ìˆ¨ê¹€ ì²˜ë¦¬

---

## 2025-12-05 (Week 16 ê³„ì†)

### QR ìŠ¤ìº” ì¶”ì  ì‹œìŠ¤í…œ ì™„ì„± âœ…

#### 1. Edge Function IP ì£¼ì†Œ ì²˜ë¦¬ ìˆ˜ì •
**íŒŒì¼**: `react-app/supabase/functions/qr-redirect/index.ts`
- IP ì£¼ì†Œ null í—ˆìš© (x-forwarded-for ì—†ëŠ” ê²½ìš°)
- "Unknown" ë¬¸ìì—´ ëŒ€ì‹  null ì‚¬ìš© (INET íƒ€ì… í˜¸í™˜)
- IP ì£¼ì†Œ ë°°ì—´ì—ì„œ ì²« ë²ˆì§¸ ê°’ë§Œ ì¶”ì¶œ (í”„ë¡ì‹œ ì²´ì¸ ì²˜ë¦¬)

**ë³€ê²½ ì „**:
```typescript
const ipAddress = headers.get('x-forwarded-for') || 'Unknown'
```

**ë³€ê²½ í›„**:
```typescript
const rawIpAddress = headers.get('x-forwarded-for') ||
                     headers.get('x-real-ip') ||
                     null
const ipAddress = rawIpAddress ? rawIpAddress.split(',')[0].trim() : null
```

#### 2. qr_scans í…Œì´ë¸” ìŠ¤í‚¤ë§ˆ ì—…ë°ì´íŠ¸
**íŒŒì¼**: `react-app/supabase/migrations/20251205000001_add_qr_scans_columns.sql` (ì‹ ê·œ)
- `browser` ì»¬ëŸ¼ ì¶”ê°€ (VARCHAR 50)
- `os` ì»¬ëŸ¼ ì¶”ê°€ (VARCHAR 50)
- `qr_codes.scan_count` ì»¬ëŸ¼ ì¶”ê°€ (INTEGER DEFAULT 0)
- ì¸ë±ìŠ¤ ì¶”ê°€ (`idx_qr_scans_browser`, `idx_qr_scans_os`)

```sql
ALTER TABLE public.qr_scans ADD COLUMN IF NOT EXISTS browser VARCHAR(50);
ALTER TABLE public.qr_scans ADD COLUMN IF NOT EXISTS os VARCHAR(50);
ALTER TABLE public.qr_codes ADD COLUMN IF NOT EXISTS scan_count INTEGER DEFAULT 0;
```

#### 3. QR ì½”ë“œ URL í‘œì‹œ ê°œì„ 
**íŒŒì¼**: `react-app/src/components/QRCodeGenerator.tsx`
- Supabase Edge Function URL ëŒ€ì‹  g-plat.com/q/ ê²½ë¡œ í‘œì‹œ
- ì‚¬ìš©ìì—ê²Œ ë” ê¹”ë”í•œ URL ì œê³µ

**ë³€ê²½ ì „**:
```typescript
const trackingUrl = `${supabaseUrl}/functions/v1/qr-redirect/${shortCode}`
```

**ë³€ê²½ í›„**:
```typescript
const trackingUrl = `https://g-plat.com/q/${shortCode}`
```

#### 4. í´ë¼ì´ì–¸íŠ¸ ì‚¬ì´ë“œ ë¦¬ë‹¤ì´ë ‰íŠ¸ êµ¬í˜„
**íŒŒì¼**: `react-app/src/pages/QRRedirectPage.tsx` (ì‹ ê·œ)
- Vercel rewrites/redirects ìˆœì„œ ë¬¸ì œ í•´ê²°
- React Routerë¥¼ í†µí•œ Edge Function ë¦¬ë‹¤ì´ë ‰íŠ¸

**íŒŒì¼**: `react-app/src/App.tsx`
- `/q/:code` ë¼ìš°íŠ¸ ì¶”ê°€

**êµ¬í˜„ ë¡œì§**:
```typescript
useEffect(() => {
  if (code) {
    const edgeFunctionUrl = `${SUPABASE_URL}/functions/v1/qr-redirect/${code}`
    window.location.href = edgeFunctionUrl
  }
}, [code])
```

#### 5. Edge Function ì¬ë°°í¬
```bash
SUPABASE_ACCESS_TOKEN="xxx" npx supabase functions deploy qr-redirect --no-verify-jwt --project-ref anwwjowwrxdygqyhhckr
```
- `--no-verify-jwt` í”Œë˜ê·¸ í•„ìˆ˜ (ì¸ì¦ ì—†ì´ ì ‘ê·¼ í•„ìš”)

### ê²€ì¦ ì™„ë£Œ
- âœ… QR ë¦¬ë‹¤ì´ë ‰íŠ¸: `/q/pp4emq` â†’ `/card/ds-lee`
- âœ… ìŠ¤ìº” ê¸°ë¡ ì €ì¥: qr_scans í…Œì´ë¸”ì— ì •ìƒ ì €ì¥
- âœ… í†µê³„ ì¡°íšŒ: ê´€ë¦¬ì ëŒ€ì‹œë³´ë“œì—ì„œ ìŠ¤ìº” í†µê³„ ì •ìƒ í‘œì‹œ
- âœ… ë””ë°”ì´ìŠ¤/ë¸Œë¼ìš°ì €/OS ì¶”ì : ëª¨ë“  ì •ë³´ ì •ìƒ ìˆ˜ì§‘

### ë¬¸ì„œ ì—…ë°ì´íŠ¸
- `CLAUDE.md`: QR ìŠ¤ìº” ì¶”ì  ì™„ì„± ê¸°ë¡
- `docs/roadmap/current-phase.md`: Week 16 ì™„ë£Œ ë‚´ì—­ ì—…ë°ì´íŠ¸
- `docs/features/qr-system/README.md`: QR ì‹œìŠ¤í…œ ë¬¸ì„œ ì‹ ê·œ ì‘ì„±
- `docs/INDEX.md`: QR ì‹œìŠ¤í…œ ë¬¸ì„œ ë§í¬ ì¶”ê°€

---

## 2025-12-04 (Week 16)

### QR ì½”ë“œ ì‹œìŠ¤í…œ ì™„ì„± âœ…

#### 1. QR ì½”ë“œ ìë™ ìƒì„± ê¸°ëŠ¥
**íŒŒì¼**: `react-app/src/lib/qr.ts` (ì‹ ê·œ)
- QR ì½”ë“œ ìƒì„± ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜ ì¶”ê°€
  - `createQRCodeForCard()`: ëª…í•¨ì— QR ì½”ë“œ ìƒì„±
  - `getOrCreateQRCodeUrl()`: QR URL ë°˜í™˜
- 6ìë¦¬ ëœë¤ short_code ìƒì„±
- ì¤‘ë³µ ì²´í¬ ë° ì¬ì‹œë„ ë¡œì§
- í”„ë¡œë•ì…˜/ê°œë°œ í™˜ê²½ ë¶„ê¸°

**íŒŒì¼**: `react-app/src/pages/CreateCardPageOptimized.tsx`
- ëª…í•¨ ìƒì„± ì‹œ QR ì½”ë“œ ìë™ ìƒì„±
- ëª…í•¨ ìƒì„± ì„±ê³µ í›„ `createQRCodeForCard()` í˜¸ì¶œ
- ì»¤ìŠ¤í…€ URL ë˜ëŠ” ëª…í•¨ IDë¡œ QR íƒ€ê²Ÿ URL ìƒì„±

**íŒŒì¼**: `react-app/supabase/migrations/20251204000002_create_qr_for_existing_cards.sql` (ì‹ ê·œ)
- ê¸°ì¡´ ëª…í•¨ì— QR ì½”ë“œ ìë™ ìƒì„± SQL
- `generate_short_code()` í•¨ìˆ˜: ì¤‘ë³µ ì—†ëŠ” 6ìë¦¬ ì½”ë“œ ìƒì„±
- 19ê°œ ê¸°ì¡´ ëª…í•¨ì— QR ì½”ë“œ ìƒì„± ì™„ë£Œ

**ì»¤ë°‹**: `bfe9e49` - feat: ëª…í•¨ ìƒì„± ì‹œ QR ì½”ë“œ ìë™ ìƒì„± ê¸°ëŠ¥ ì¶”ê°€

#### 2. QR ì½”ë“œ ê³µìœ  ê¸°ëŠ¥ í™œì„±í™”
**íŒŒì¼**: `react-app/src/components/QRCodeGenerator.tsx`
- Web Share API êµ¬í˜„
  - QR ì½”ë“œ ì´ë¯¸ì§€ë¥¼ Blobìœ¼ë¡œ ë³€í™˜
  - `navigator.share()` API ì‚¬ìš©
  - Fallback: URL í´ë¦½ë³´ë“œ ë³µì‚¬
- í†µê³„ ë²„íŠ¼ ì œê±° (ì¤‘ë³µ UI ì œê±°)
- ê³µìœ  ë²„íŠ¼ í™œì„±í™”

**ì»¤ë°‹**: `6019c0d` - fix: QR ì½”ë“œ ê¸°ëŠ¥ ê°œì„  ë° ê´€ë¦¬ì RLS ì •ì±… ì¶”ê°€

#### 3. QR ë¦¬ë‹¤ì´ë ‰íŠ¸ ì‹œìŠ¤í…œ ìˆ˜ì •
**íŒŒì¼**: `react-app/vercel.json`
- rewrites ê·œì¹™ ìˆ˜ì •
  - Before: `"source": "/(.*)"`
  - After: `"source": "/:path((?!q).*)*)"`
  - `/q/` ê²½ë¡œë¥¼ rewritesì—ì„œ ì œì™¸
- redirectsê°€ ì •ìƒ ì‘ë™í•˜ë„ë¡ ê°œì„ 

**ë¬¸ì œ**:
- Vercel rewritesê°€ ëª¨ë“  ê²½ë¡œë¥¼ index.htmlë¡œ ë³´ë‚´ë©´ì„œ redirects ë¬´ì‹œ
- QR ì½”ë“œ ìŠ¤ìº” ì‹œ ë¹ˆ í˜ì´ì§€ í‘œì‹œ

**í•´ê²°**:
- `/q/:code` ê²½ë¡œë§Œ Edge Functionìœ¼ë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸
- ë‚˜ë¨¸ì§€ ê²½ë¡œëŠ” SPA index.htmlë¡œ ì²˜ë¦¬

**í…ŒìŠ¤íŠ¸**:
```bash
curl -I "https://g-plat.com/q/urh0tm"
# HTTP 302 Found
# Location: https://anwwjowwrxdygqyhhckr.supabase.co/functions/v1/qr-redirect/urh0tm
```

**ì»¤ë°‹**: `9b461d8` - fix: QR ì½”ë“œ ë¦¬ë‹¤ì´ë ‰íŠ¸ ê²½ë¡œ ì„¤ì • ìˆ˜ì •

#### 4. Admin QR ê´€ë¦¬ ê°œì„ 
**íŒŒì¼**: `admin-app/src/types/admin.ts`
- `QRCodeWithDetails` ì¸í„°í˜ì´ìŠ¤ ìˆ˜ì •
  - `business_card.user_id` ì¶”ê°€
  - TypeScript ë¹Œë“œ ì—ëŸ¬ í•´ê²°

**íŒŒì¼**: `react-app/supabase/migrations/20251204000001_qr_admin_policies.sql`
- Admin RLS ì •ì±… ì¶”ê°€
  - `is_admin_user()` í•¨ìˆ˜ ì‚¬ìš©
  - SELECT, UPDATE ì •ì±… ì¶”ê°€
  - ê´€ë¦¬ìê°€ ëª¨ë“  QR ì½”ë“œ ì¡°íšŒ/ìˆ˜ì • ê°€ëŠ¥

**íŒŒì¼**: `admin-app/src/components/layout/Sidebar.tsx`
- QR ì½”ë“œ ë©”ë‰´ëª… ë³€ê²½
  - Before: "QR ì½”ë“œ"
  - After: "QR ì½”ë“œ ê´€ë¦¬"

**ì»¤ë°‹**:
- `d2fc874` - fix: Admin App QR ê´€ë¦¬ TypeScript íƒ€ì… ì •ì˜ ìˆ˜ì •
- `6019c0d` - fix: QR ì½”ë“œ ê¸°ëŠ¥ ê°œì„  ë° ê´€ë¦¬ì RLS ì •ì±… ì¶”ê°€

### ê¸°ìˆ  ê°œì„ 
- TypeScript ë¹Œë“œ ì—ëŸ¬ 0ê°œ
- Vercel ë°°í¬ ì„±ê³µ
- Edge Function ë¦¬ë‹¤ì´ë ‰íŠ¸ ì •ìƒí™”
- QR ì½”ë“œ ì‹œìŠ¤í…œ ì™„ì „ ìë™í™”

---

## 2025-12-01 (Week 15)

### Admin App QR ì½”ë“œ ê´€ë¦¬ ëª¨ë“ˆ ì¶”ê°€ âœ…

#### íŒŒì¼ ë³€ê²½ì‚¬í•­
- `admin-app/src/pages/qr/QrCodesPage.tsx` (ì‹ ê·œ)
- `admin-app/src/components/qr/QrDetailModal.tsx` (ì‹ ê·œ)
- `admin-app/src/lib/api/qr.ts` (ì‹ ê·œ)
- `admin-app/src/types/admin.ts` ì—…ë°ì´íŠ¸

ìì„¸í•œ ë‚´ìš©ì€ [2025ë…„ 11ì›” ë³€ê²½ ì´ë ¥](2025-11.md) ì°¸ì¡°
